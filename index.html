<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Curved Plane Animation</title>
  <style>
    body {
      margin: 0;
      background-color: midnightblue;
    }
    .map-container {
      position: relative;
      width: 447.2px;
      height: 357.6px;
      margin: 0 auto;
    }
    .map-container img {
      width: 100%;
      height: 100%;
      display: block;
    }
    svg {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
    .plane {
      width: 30px;
      transform-origin: center;
    }
  </style>
</head>
<body>

<div class="map-container">
  <img src="USMap.png" alt="Map">
  <svg viewBox="0 0 447.2 357.6" preserveAspectRatio="xMidYMid meet">
    <!-- Curved path from Point A to Point B -->
    <path id="flightPath" d="M80,200 Q216,96 392,120" fill="none" stroke="none" />

    <!-- Plane image following the path -->
    <image id="plane" href="paperplanenew.png" class="plane" width="30" height="30"/>
  </svg>
</div>

<script>
  const path = document.getElementById("flightPath");
  const plane = document.getElementById("plane");

  const totalLength = path.getTotalLength();
  let direction = 1;
  let progress = 0;

  // Set initial position
  const startPt = path.getPointAtLength(progress);
  const nextPt = path.getPointAtLength(progress + 1);
  const initialAngle = Math.atan2(nextPt.y - startPt.y, nextPt.x - startPt.x) * (180 / Math.PI);
  plane.setAttribute("x", startPt.x - 15);
  plane.setAttribute("y", startPt.y - 15);
  plane.setAttribute("transform", `rotate(${initialAngle}, ${startPt.x}, ${startPt.y})`);

  function animate() {
    progress += direction * 2;

    if (progress >= totalLength || progress <= 0) {
      direction *= -1;
    }

    const pt = path.getPointAtLength(progress);
    const nextPt = path.getPointAtLength(progress + direction * 1);
    const angle = Math.atan2(nextPt.y - pt.y, nextPt.x - pt.x) * (180 / Math.PI);

    plane.setAttribute("x", pt.x - 15);
    plane.setAttribute("y", pt.y - 15);
    plane.setAttribute("transform", `rotate(${angle}, ${pt.x}, ${pt.y})`);

    requestAnimationFrame(animate);
  }

  animate();
</script>

</body>
</html>
